<!DOCTYPE html>
<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">

<div id="background"></div>

<!-- Tabs & Tables -->
	<div id="container">
		<ul class="nav nav-pills" >
			<li class="active">
				<a href="#alumni-roster" data-toggle="tab">Alumni Roster</a>
			</li>
			<li class="">
				<a href="#mentorapp" data-toggle="tab" >Alumni Mentor Application</a>
			</li>
			<!--<li class="">
				<a href="#signout" data-toggle="tab" id="signout">Sign Out</a>
      </li>-->
		</ul>
	</div>

	<!-- Tabs & Tables -->
	<div class="tab-content">
		<div role="tabpanel" class="tab-pane active" id="alumni-roster" >
			<div id = "table" class="table"></div>
		</div>

		<div role="tabpanel" class="tab-pane" id="mentorapp">
			<!-- Change the width and height values to suit you best -->
			<div class="typeform-widget" data-url="//hekuang.typeform.com/to/sycxh4" data-text="Alumni Mentor Application" style="width:100%;height:100%;"></div>
			<script>(function(){var qs,js,q,s,d=document,gi=d.getElementById,ce=d.createElement,gt=d.getElementsByTagName,id='typef_orm',b='https://s3-eu-west-1.amazonaws.com/share.typeform.com/';if(!gi.call(d,id)){js=ce.call(d,'script');js.id=id;js.src=b+'widget.js';q=gt.call(d,'script')[0];q.parentNode.insertBefore(js,q)}})()</script>
		</div>
	</div>

<style type="text/css">
	#table{
	padding:1%;
	padding-top:0;
	max-width:100%;
	opacity: 0.95;
	position:absolute;
	top:10%;}
	
	#table td{
	white-space: pre;
	}

	tfoot input {
        width: 100%;
        padding: 3px;
        box-sizing: border-box;
    }
	tfoot {
		display: table-header-group;
		font-size: 10px;
	}
	
	#background {
		background-image:url(https://localwiki.org/media/cache/30/15/301526f871b0355b8c5981f5fc9a35a9.jpg);
	   background-repeat:no-repeat;
	   background-position: center;
	   opacity: 0.6;
	   position: absolute;
	   width:100%;
	   height:100%;
	}
	#container li {
		display: inline-block !important;
		float: none !important;
		margin-top: 2%;
	}

	#container .nav-pills {
		text-align: center;
	}
	
	html, body, .tab-content, #mentorapp
	{
		height: 100%;
	}
	</style>

</html>

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/s/bs-3.3.5/jq-2.1.4,pdfmake-0.1.18,dt-1.10.10,b-1.1.0,b-colvis-1.1.0,b-flash-1.1.0,b-html5-1.1.0,b-print-1.1.0,cr-1.3.0,fc-3.2.0,fh-3.1.0,r-2.0.0,se-1.1.0/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/s/bs-3.3.5/jq-2.1.4,pdfmake-0.1.18,dt-1.10.10,b-1.1.0,b-colvis-1.1.0,b-flash-1.1.0,b-html5-1.1.0,b-print-1.1.0,cr-1.3.0,fc-3.2.0,fh-3.1.0,r-2.0.0,se-1.1.0/datatables.min.js"></script>


<script>
function cellEntries(json, dest) {
    var table = document.createElement('table');
    var thead = document.createElement('thead');
    var tbody = document.createElement('tbody');
	var tfoot = document.createElement('tfoot');
    var thr;
	var thf;
    var tr;
    var entries = json.feed.entry;
    var cols = json.feed.gs$colCount.$t;

	/* Create column headers */
    for (var i=0; i < cols; i++) {
        var entry = json.feed.entry[i];
        if (entry.gs$cell.col == '1') {
            if (thr != null) {
                tbody.appendChild(thr);
            }
            thr = document.createElement('tr');
        }
        var th = document.createElement('th');
        th.appendChild(document.createTextNode(entry.content.$t));
		if( i == 3 || (i >= 9 && i <= 50) && i != 18 && i != 19 && i != 22)
			th.className = "none";
        thr.appendChild(th);
    } 
	
	/* Create column footers */
    for (var i=0; i < cols; i++) {
        var entry = json.feed.entry[i];
        if (entry.gs$cell.col == '1') {
            if (thf != null) {
                tfoot.appendChild(thf);
            }
            thf = document.createElement('tr');
        }
        var th = document.createElement('th');
		th.appendChild(document.createTextNode(entry.content.$t));
		thf.appendChild(th);
    } 

	/* Create table cells */
	var items_added = 0;
    for (var i=cols; i < json.feed.entry.length; i++) {
        var entry = json.feed.entry[i];
        if (entry.gs$cell.col == '1') {
            if (tr != null) {
				while ( items_added != cols)
				{
					var td = document.createElement('td'); 
					td.appendChild(document.createTextNode(" "));
					tr.appendChild(td);
					items_added++;
				}
                tbody.appendChild(tr);
            }
            tr = document.createElement('tr');
			items_added = 0;
        }
		if( items_added+1 < entry.gs$cell.col)
		{
			while ( items_added != entry.gs$cell.col-1)
			{
				var td = document.createElement('td');  
				td.appendChild(document.createTextNode(" "));
				tr.appendChild(td);
				items_added++;
			}
		}
		var td = document.createElement('td');	
		td.appendChild(document.createTextNode(entry.content.$t));
		tr.appendChild(td);
		items_added++;
	}
	
    $(thead).append(thr);
	$(tfoot).append(thf);
    $(tbody).append(tr);
    $(table).append(thead);
	$(table).append(tfoot);
    $(table).append(tbody);
    $(dest).append(table);
	
	var table = document.getElementsByTagName('table')[0];
    var trs = table.getElementsByTagName('tr'), 
        len = trs.length, max = 0, td;
    // first we search for the longest table row in terms of # of children 
    for (var i = len; i--;) {
        if (trs[i].children.length > max) 
            max = trs[i].children.length;
    }
    // now we can fill the other rows
    for (var j = len; j--;) {
        while (trs[j].children.length < max) {
            td = document.createElement('td');
            trs[j].appendChild(td);
        }
    }
	
    $(dest + ' table').dataTable({
		responsive: true,
		select: true,
		aaSorting: [],
		oLanguage: {
			sInfo: "Showing _START_ to _END_ of _TOTAL_ alumni",
			sLengthMenu: 'Show <select class="form-control input-sm">'+
				'<option value="15">15</option>'+
				'<option value="25">25</option>'+
				'<option value="50">50</option>'+
				'<option value="100">100</option>'+
				'<option value="-1">All</option>'+
				'</select> alumni'
		},
		iDisplayLength: 15
		/*dom: 'B<"clear">lfrtip',
		buttons: [
        'copy', 
		{
			extend: 'colvis',
			text: 'Hide Columns'
		} 
		]*/
	});

	$('#DataTables_Table_0').removeClass( 'display' ).addClass('table table-striped table-bordered display responsive nowrap dataTable no-footer dtr-inline collapsed');
	document.getElementById('DataTables_Table_0').setAttribute("style", "margin-right:4%;width:100%");
	
	var tablex = $('#DataTables_Table_0').DataTable();
	
	/* Create individual column filtering */
	$('#DataTables_Table_0 tfoot th').each( function (i) {
        var title = $(this).text();
		if( title != "Pledge class" )//&& title != "Company")
			$(this).html( '<input class="form-control input-sm" style="width:100%;font-weight:normal;"type="text" placeholder="Search '+title+'" />' );		
		else
		{
			var select = $('<select ' /*+ (title == "Company" ? 'id="col_company"' : ' ')*/ + 'class="form-control input-sm" style="width:100%;font-weight:normal;"><option value="">All</option></select>')
				.appendTo( $(this).empty() )
				.on( 'change', function () {
					var val = $(this).val();
	 
					tablex.column( i )
					.search( val ? '^'+$(this).val()+'$' : val, true, false )
					.draw();
				} );
			
			tablex.column( i ).data().unique().each( function ( d, j ) {
                select.append( '<option value="'+d+'">'+d+'</option>' )
            } );
		}
	} );
	
	/* $("#col_company").html($("#col_company option").sort(function (a, b) {
    return (a.text != "All" || b.text != "All") ? a.text == b.text ? 0 : a.text < b.text ? -1 : 1 : 0;
	})) */
	
	// Apply the search
    tablex.columns().every( function () {
        var column = this;	
		var title = $(this).text();
		if( title != "Pledge class")
		{
			$( 'input', this.footer() ).on( 'keyup change', function () {
				if ( column.search() !== this.value ) {
					column.search( this.value ).draw();
				}
			} );
		}
    } );
	
	
	$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		var target = $(e.target).attr("href") // activated tab
		if( target == "#mentorapp")
			document.body.setAttribute("style", "overflow:hidden");	
		else document.body.setAttribute("style", "overflow:auto");	
	});
}

function importGSS(json){
   cellEntries(json, '#table');
};
</script>

<script src="https://spreadsheets.google.com/feeds/cells/1mPeK2XiAjgCrawK4bxDuDS_PwEfZze8xl8LnOiL0X30/4/public/values?alt=json-in-script&callback=importGSS"></script>
  </head>
  </html>
